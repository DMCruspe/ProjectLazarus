'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.index = index;
exports.dropIndexes = dropIndexes;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _assert = require('assert');

var _assert2 = _interopRequireDefault(_assert);

var _utils = require('../utils');

function index() {
  var _this = this;

  var args = _lodash2['default'].toArray(arguments);
  var callback = (0, _utils.getCallback)(args) || _assert2['default'].ifError;
  var keys = args.shift();
  var options = args.shift() || {};

  if (_lodash2['default'].isString(keys)) {
    keys = _defineProperty({}, keys, 1);
  }
  _lodash2['default'].defaults(options, { unique: true });

  this.on('ready', function () {
    return _this._collection.ensureIndex(keys, options, function (error) {

      if (error) {
        return callback(error);
      }
      callback();
    });
  });
}

function dropIndexes(callback) {
  var _this2 = this;

  this.on('ready', function () {
    return _this2._collection.dropAllIndexes(callback);
  });
}